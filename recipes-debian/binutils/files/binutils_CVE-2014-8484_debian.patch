diff --git a/bfd/ChangeLog b/bfd/ChangeLog
index d7265d4..64e6102 100644
--- a/bfd/ChangeLog
+++ b/bfd/ChangeLog
@@ -1,3 +1,8 @@
+2014-08-29  Alan Modra  <amodra@gmail.com>
+
+	* srec.c (srec_scan): Revert last change.  Report an error for
+	S-records with less than the miniumum byte count.
+
 2014-08-18  Alan Modra  <amodra@gmail.com>
 
 	* elf64-ppc.c (ppc64_elf_adjust_dynamic_symbol): Don't attempt to
diff --git a/bfd/srec.c b/bfd/srec.c
index 4133d86..06a9ef8 100644
--- a/bfd/srec.c
+++ b/bfd/srec.c
@@ -453,7 +453,7 @@ srec_scan (bfd *abfd)
 	  {
 	    file_ptr pos;
 	    char hdr[3];
-	    unsigned int bytes;
+	    unsigned int bytes, min_bytes;
 	    bfd_vma address;
 	    bfd_byte *data;
 	    unsigned char check_sum;
@@ -476,7 +476,19 @@ srec_scan (bfd *abfd)
 	      }
 
 	    check_sum = bytes = HEX (hdr + 1);
-            if (bytes == 0) goto error_return;
+
+            min_bytes = 3;
+            if (hdr[0] == '2' || hdr[0] == '8')
+              min_bytes = 4;
+            else if (hdr[0] == '3' || hdr[0] == '7')
+              min_bytes = 5;
+            if (bytes < min_bytes)
+              {
+                (*_bfd_error_handler) (_("%B:%d: byte count %d too small\n"),
+                                       abfd, lineno, bytes);
+                bfd_set_error (bfd_error_bad_value);
+                goto error_return;
+              }
 
 	    if (bytes * 2 > bufsize)
 	      {
